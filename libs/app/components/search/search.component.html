<ng-container *ngIf="mod === 'icon'; else searchInput">
	<button ng-doc-button-icon size="large" (click)="inputDropdown.toggle()" ngDocDropdownOrigin>
		<ng-doc-icon icon="search" [size]="24"></ng-doc-icon>

		<ng-doc-dropdown
			[content]="dropdownContent"
			panelClass="ng-doc-search-dropdown"
			width="100%"
			height="80vh"
			#inputDropdown
		>
			<ng-template #dropdownContent>
				<div class="ng-doc-search-wrapper">
					<ng-doc-input-wrapper [leftContent]="leftContent" ngDocDropdownOrigin>
						<ng-template #leftContent>
							<ng-doc-icon icon="search"></ng-doc-icon>
						</ng-template>
						<input
							ngDocInputString
							[(ngModel)]="searchTerm"
							(ngModelChange)="query$.next($event)"
							placeholder="Search..."
							ngDocAutofocus
						/>
					</ng-doc-input-wrapper>
					<div class="ng-doc-search-result-content">
						<!--						<ng-doc-search-result [result]="queryResult"></ng-doc-search-result>-->
					</div>
				</div>
			</ng-template>
		</ng-doc-dropdown>
	</button>
</ng-container>

<ng-template #searchInput>
	<ng-doc-input-wrapper
		[leftContent]="leftContent"
		[rightContent]="rightContent"
		ngDocDropdownOrigin
		ngDocFocusCatcher
		(focusEvent)="inputElement.value ? dropdown.open() : null"
		(click)="inputElement.value ? dropdown.open() : null"
		#input
	>
		<ng-template #leftContent>
			<ng-doc-icon icon="search"></ng-doc-icon>
		</ng-template>
		<input
			ngDocInputString
			[(ngModel)]="searchTerm"
			(ngModelChange)="query$.next($event); dropdown.open()"
			placeholder="Search..."
			[ngDocHotkey]="{ctrlKey: false, altKey: false, shiftKey: false, code: 'Slash'}"
			(ngDocHotkey)="inputElement.focus()"
			#inputElement
		/>
		<ng-template #rightContent>
			<ng-doc-tag class="search-hotkey">/</ng-doc-tag>
		</ng-template>
		<ng-doc-dropdown
			[content]="dropdownContent"
			[width]="input.elementRef.nativeElement.offsetWidth"
			maxHeight="calc(95vh - var(--ng-doc-navbar-height)"
			#dropdown
		>
			<ng-template #dropdownContent>
				<div class="ng-doc-search-result-content">
					<ng-doc-data-list-group
						[items]="queryResult"
						[itemContent]="itemContent"
						[groupContent]="groupContent"
						[itemGroupFn]="groupByPage"
					>
						<ng-template let-group #groupContent>
							<div class="ng-doc-group-header" *ngDocLet="getPageTypeForGroup(group) as pageType">
								<ng-doc-tag size="small" [color]="pageType === 'api' ? 'red' : 'blue'">
									{{ pageType }}
								</ng-doc-tag>
								{{ group }}
							</div>
						</ng-template>
						<ng-template let-item #itemContent>
							<h5
								class="ng-doc-search-section-title"
								ng-doc-text
								[innerHTML]="
									item.document.sectionTitle
										| ngDocHighlighterPipe: getPositions('sectionTitle', item)
								"
							></h5>
							<div
								[innerHTML]="
									item.document.content | ngDocHighlighterPipe: getPositions('content', item)
								"
							></div>
						</ng-template>
					</ng-doc-data-list-group>
				</div>
			</ng-template>
		</ng-doc-dropdown>
	</ng-doc-input-wrapper>
</ng-template>
